<%-include("header")-%>

  <!-- registration Page -->

  <!-- <div class="container-fluid">
        <div></div>
       </div> -->

  <section style="background-color: black;">

    <div class="mask d-flex align-items-center h-100 gradient-custom-3">
      <div class="container h-100 p-5 text-white">
        <div class="row d-flex justify-content-center align-items-center h-100">
          <div class="col-12 col-md-9 col-lg-7 col-xl-6 ">
            <div class="card bg-dark" style="border-radius: 15px; ">
              <div class="card-body p-5">
                <h2 class="text-uppercase text-center mb-5">Reset new password</h2>

                <form action="/api/updateforgototp" method="post">

                  <div class="form-outline mb-2">
                    <label class="form-label" for="form3Example1cg">new password</label>
                    <input type="password" id="password" class="form-control form-control-lg" name="password" />
                    <small class="text-danger" id="passwordErrField"></small>
                    <!-- <label class="form-label" for="form3Example1cg">name</label> -->
                  </div>

                  <div class="form-outline mb-2">
                    <label class="form-label" for="form3Example4cdg">confirm your password</label>
                    <input type="password" id="confirmPassword" class="form-control form-control-lg"
                      name="confirmPassword" />
                    <small class="text-danger" id="confimPasswordErrField"></small>
                    <!-- <label class="form-label" for="form3Example4cdg">email</label> -->
                  </div>


                  <div class="d-flex justify-content-center">
                    <button class=" btn-warning btn-block btn-lg gradient-custom-4 text-body" id="btn">submit</button>
                  </div>

                  <!-- <p class="text-center text-muted mt-5 mb-0">Have already an account? <a href="#!"
                          class="fw-bold text-body"><u>Login here</u></a></p> -->

                </form>

              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>


  <script>

    console.log('jiiiii');

    var btn = document.getElementById('btn')
    console.log(btn);



    btn.addEventListener('click', (event) => {
      event.preventDefault()


      var password = document.getElementById('password').value
      var confirmPassword = document.getElementById('confirmPassword').value


      const form = btn.form

      console.log('lkkl', password, confirmPassword);

      let passwordErrMsg =[]
      let confirmPasswordErrMsg = []


      
      let cPasswordErrField = document.getElementById('passwordErrField')
      let passwordErrField = document.getElementById('confimPasswordErrField')


      const passworRegex=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*()-=_+[\]{};':"\\|,.<>/?]).{8,}$/;



      if(!passworRegex.test(password)&&password.trim() !== ''){
        passwordErrMsg.push('Weak password. Use a combination of uppercase and lowercase letters, numbers, and special characters. Ensure it is at least 8 characters long.')
      }  


      if (password.trim() == '') {

        passwordErrMsg.push('This field is required')


      }

      if (confirmPassword.trim() == '') {

        confirmPasswordErrMsg.push('This field is required')


      }

      if(!passworRegex.test(password)&&password.trim() !== ''){
        passwordErrMsg.push('Weak password. Use a combination of uppercase and lowercase letters, numbers, and special characters. Ensure it is at least 8 characters long.')
      }





      if(passwordErrMsg.length>0){
        document.getElementById('password').classList.add('is-invalid')
        document.getElementById('password').classList.remove('is-Valid')
        document.getElementById('password').setAttribute('title','Weak password. Use a combination of uppercase and lowercase letters, numbers, and special characters. Ensure it is at least 8 characters long.')
      }else{
        document.getElementById('password').classList.remove('is-invalid')
        document.getElementById('password').classList.add('is-valid')
      }

      if(confirmPasswordErrMsg.length>0){
        document.getElementById('confirmPassword').classList.add('is-invalid')
        document.getElementById('confirmPassword').classList.remove('is-Valid')
      }else{
        document.getElementById('confirmPassword').classList.remove('is-invalid')
        document.getElementById('confirmPassword').classList.add('is-valid')
      }
      




      cPasswordErrField.innerText=passwordErrMsg.join(',')
      passwordErrField.innerText=confirmPasswordErrMsg.join(',')


      if (passwordErrMsg.length === 0 && confirmPasswordErrMsg.length == 0 ) {

        form.submit();
      }








    })

  </script>


  <!-- registration Page -->





  <%-include("footer")-%>